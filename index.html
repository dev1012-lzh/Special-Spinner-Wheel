<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Spinner Wheel</title>
    <link rel="shortcut icon" href="https://www.rw-designer.com/icon-view/22109.png" type="image/x-icon">
    <!--
    README - IMPORTANT
    Guidelines for Spinner Wheel Site:
    1. This site is for EDUCATIONAL/FUN/PERSONAL purposes only. Do not use in commercial applications.
    2. Do not attempt to manipulate or use the spinner for gambling or real-world decision making.
    3. The spinner numbers and results are for demonstration and learning only.
    4. You may customize the prank numbers using the browser console, but changes are LOCAL to your device.
    5. The developer is NOT responsible for any misuse or damages resulting from use of this spinner.
    6. Use responsibly. DO NOT SHARE OR DEPLOY this site for COMMERCIAL use. USE EMBEDDED IN COMMERCIAL SCENARIOS.
    7. By using this site, you agree to these terms. If you do not agree, do not use. Easy as that.
    8. Enjoy learning and experimenting with the spinner responsibly!
    -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #121212;
            --text-color: #ffffff;
            --accent-color: #36a195;
            --slice-light: hsl(34, 100%, 50%);
            --slice-dark: hsl(0, 42%, 43%);
            --font-family: Poppins;
        }

        html {
            margin: 0;
            padding: 0;
        }

        body {

            background: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-family);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            user-select: none;

        }

        h1 {
            padding: 10px;
            margin: 0;
            display: block;
            position: absolute;
            top: 0px;
            left: 0;


            width: 100%;
            background-color: #555;
        }

        #wheel-container {
            position: relative;
            width: 90vmin;
            max-width: 500px;
            aspect-ratio: 1 / 1;
        }

        canvas#wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
            background: transparent;
        }

        .pointer {
            position: absolute;
            top: 0px;
            left: 50%;
            transform: translateX(-50%) rotate(180deg);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 30px solid var(--accent-color);
            filter: drop-shadow(-5px 5px 5px rgba(0,0,0,0.5)) drop-shadow(5px 5px 5px rgba(0,0,0,0.5)) drop-shadow(0px 10px 8px rgba(0,0,0,0.7));
            z-index: 3;
        }

        button#spin-btn {
            margin-top: 1em;
            padding: 12px 36px;
            font-size: 1.2rem;
            font-family: var(--font-family);
            background: var(--accent-color);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button#spin-btn:disabled {
            background: #555;
            cursor: wait;
            opacity: 0;
        }

        button#spin-btn:hover:not(:disabled) {
            background: #79cbcc;
            opacity: 1;
            color: black;
        }

        #result {
            margin-top: 1em;
            font-size: 1.4rem;
            min-height: 1.5em;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--accent-color);
            padding: 10px;
            border-radius: 8px;
            display: none;
            z-index: 999;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.5);
            border: 0px solid solid;
            outline: 0px solid;

        }
    </style>
</head>
<!--EDUCATIONAL PURPOSES ONLY - DO NOT USE IN COMMERCIAL APPLICATIONS AND SCENARIOS-->
<body>
    <h1>Spinner</h1>
    <div id="wheel-container">
        <div class="pointer"></div>
        <canvas id="wheel" width="500" height="500" aria-label="Spinner wheel"></canvas>
    </div>
    <button id="spin-btn">Spin!</button>
    <div id="result" aria-live="polite"></div>
    <!--<a href="https://github.com/dev1012-lzh/Special-Spinner-Wheel/tree/main" style="color:white;">How to use</a>-->

    <script>
        const canvas = document.getElementById('wheel'),
            ctx = canvas.getContext('2d'),
            spinBtn = document.getElementById('spin-btn'),
            resultEl = document.getElementById('result'),
            numSlices = 42,
            sliceAngle = (2 * Math.PI) / numSlices,
            center = canvas.width / 2,
            radius = center - 10;

        // Default prank numbers
        const defaultPrankNumbers = [36, 15, 10, 17, 12, 21, 34, 13, 38, 33];
        

        // Load prank numbers from localStorage or use shuffled default
        function loadPrankNumbers() {
            const stored = localStorage.getItem('prankNumbers');
            if (stored) {
                const arr = stored.split(',')
                    .map(s => parseInt(s.trim()))
                    .filter(n => !isNaN(n) && n >= 1 && n <= numSlices);
                if (arr.length > 0) return arr;
            }
            // Shuffle default prank numbers before returning
            return defaultPrankNumbers.slice();
        }
        let prankNumbers = loadPrankNumbers();
        console.log(' ORIGINAL https://github.com/dev1012-lzh/Special-Spinner-Wheel/blob/main/index.html ')
        console.warn("EDUCATIONAL PURPOSES ONLY - DO NOT USE IN COMMERCIAL APPLICATIONS AND SCENARIOS");
        console.log("Current prank numbers sequence:", prankNumbers);
        console.log("To update prank numbers, call setPrankNumbers('1,5,10') in the console.");
        window.setPrankNumbers = function (str) {
            if (typeof str !== 'string') {
                console.error('setPrankNumbers expects a comma-separated string of numbers.');
                return;
            }
            const arr = str.split(',')
                .map(s => parseInt(s.trim()))
                .filter(n => !isNaN(n) && n >= 1 && n <= numSlices);
            if (arr.length === 0) {
                console.error('No valid numbers found. Please provide numbers between 1 and', numSlices);
                return;
            }
            localStorage.setItem('prankNumbers', arr.join(','));
            console.log('Prank numbers updated to:', arr);
            location.reload();
        };

        function getSliceColor(i) {
            // Get CSS variables from :root
            const rootStyles = getComputedStyle(document.documentElement),
                light = rootStyles.getPropertyValue('--slice-light').trim(),
                dark = rootStyles.getPropertyValue('--slice-dark').trim();
            return i % 2 === 0 ? light : dark;
        }

        function drawWheel(rotation = 0) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(center, center);
            ctx.rotate(rotation);
            for (let i = 0; i < numSlices; i++) {
                // Draw slice
                ctx.beginPath();
                ctx.fillStyle = getSliceColor(i);
                ctx.moveTo(0, 0);
                ctx.arc(0, 0, radius, i * sliceAngle, (i + 1) * sliceAngle);
                ctx.closePath();
                ctx.fill();

                // Draw number
                ctx.save();
                ctx.fillStyle = '#000';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                const angle = i * sliceAngle + sliceAngle / 2;
                ctx.rotate(angle);
                ctx.fillText(i + 1, radius - 15, 0);
                ctx.restore();
            }
            ctx.restore();
        }

        // Web Audio API tick sound
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTick() {
            const t = audioCtx.currentTime,
                osc = audioCtx.createOscillator(),
                gain = audioCtx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(1800, t);
            gain.gain.setValueAtTime(0.0001, t);
            gain.gain.exponentialRampToValueAtTime(0.2, t + 0.004);
            gain.gain.exponentialRampToValueAtTime(0.0001, t + 0.06);
            osc.connect(gain).connect(audioCtx.destination);
            osc.start(t);
            osc.stop(t + 0.07);
        }

        // Web Audio API win sound
        function playWin() {
            const t = audioCtx.currentTime,
                osc = audioCtx.createOscillator(),
                gain = audioCtx.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(900, t);
            osc.frequency.exponentialRampToValueAtTime(220, t + 0.45);
            gain.gain.setValueAtTime(0.0001, t);
            gain.gain.exponentialRampToValueAtTime(0.6, t + 0.03);
            gain.gain.exponentialRampToValueAtTime(0.0001, t + 0.5);
            osc.connect(gain).connect(audioCtx.destination);
            osc.start(t);
            osc.stop(t + 0.5);
        }

        function getNextNumber() {
            if (prankNumbers.length > 0) {
                return prankNumbers.shift();
            }
            return Math.floor(Math.random() * numSlices) + 1;
        }
        /* ORIGINAL https://github.com/dev1012-lzh/Special-Spinner-Wheel/blob/main/index.html */
        function spinWheel() {
            audioCtx.resume();
            spinBtn.disabled = true;
            resultEl.style.display = 'none';
            resultEl.textContent = '';
            const chosenNumber = getNextNumber(),
                chosenSlice = chosenNumber - 1,
                extraRotations = Math.floor(Math.random() * 4) + 5,
                randomOffset = Math.random() * 0.02;
            // Calculate final rotation so chosen slice lands at pointer (top)
            const finalRotation =
                (extraRotations * 2 * Math.PI) -
                (chosenSlice * sliceAngle) -
                sliceAngle / 2 +
                Math.PI * 1.5 + // pointer offset
                randomOffset;
            const spinDuration = 8000 + (Math.random() * 3000);
            let startTime = null;
            let nextTickAngle = sliceAngle;
            let lastAngle = 0;

            function animate(time) {
                if (!startTime) startTime = time;
                let elapsed = time - startTime;
                let progress = Math.min(elapsed / spinDuration, 1);
                let easedProgress = 1 - Math.pow(1 - progress, 3); // EASE OUT CUBIC
                let currentAngle = finalRotation * easedProgress;
                /* ORIGINAL https://github.com/dev1012-lzh/Special-Spinner-Wheel/blob/main/index.html */
                drawWheel(currentAngle);
                while (currentAngle >= nextTickAngle) {
                    playTick();
                    nextTickAngle += sliceAngle;
                }
                lastAngle = currentAngle;
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    resultEl.style.display = 'block';
                    resultEl.innerHTML = `Winner - <b> ${chosenNumber}</b>`;
                    playWin();
                    spinBtn.disabled = false;
                }
            }
            requestAnimationFrame(animate);
        }
        spinBtn.addEventListener('click', spinWheel);
        drawWheel();        
    </script>

</body>

</html>
